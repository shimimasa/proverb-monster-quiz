# 2025-01-20 MonsterManager実装

## 実装内容

### MonsterManagerクラスの拡張
- **ファイル**: `src/core/MonsterManager.ts`
- **主な機能**:

#### 1. モンスター生成・管理機能
- コンテンツアイテムからモンスターを生成
- 既存モンスターの重複チェック
- モンスターIDは `monster_{contentType}_{contentId}` 形式
- レアリティシステム（common, rare, epic, legendary）
- 難易度別のレアリティ出現確率

#### 2. アンロック・報酬システム
- モンスターのアンロック処理
- 重複獲得時の報酬システム（経験値/コイン）
- レアリティに応じた報酬倍率
- MonsterGenerationResultインターフェースで結果を構造化

#### 3. コレクション管理機能
- 全モンスター/アンロック済みモンスターの取得
- ID、レアリティ、コンテンツタイプ別のフィルタリング
- 最近アンロックしたモンスターの取得
- コレクション統計（総数、アンロック数、レアリティ別統計）

#### 4. 進捗管理機能
- 図鑑完成度の計算
- 次のマイルストーン（25%, 50%, 75%, 100%）までの必要数
- レアリティ別の完成度統計

#### 5. LocalStorageとの統合
- localStorageManagerを使用したデータ永続化
- 起動時の自動データ読み込み
- 変更時の自動保存

#### 6. デバッグ機能
- コレクションのリセット
- 全モンスターの即座アンロック

### テストの作成
- **ファイル**: `tests/core/MonsterManager.test.ts`
- **テスト内容**:
  - 22個のテストケース全て成功
  - モンスター生成、アンロック、報酬システムのテスト
  - コレクション管理機能のテスト
  - レアリティシステムのテスト（難易度による分布の違い）
  - LocalStorageとの連携テスト

## 技術的な詳細

### レアリティ確率システム
```typescript
小学生: { common: 0.6, rare: 0.3, epic: 0.08, legendary: 0.02 }
中学生: { common: 0.5, rare: 0.35, epic: 0.12, legendary: 0.03 }
高校生: { common: 0.4, rare: 0.4, epic: 0.15, legendary: 0.05 }
```

### モンスター名生成
- コンテンツの最初のキーワード + テンプレートの接尾辞
- 例: "猿も木から落ちる" → "猿ドラゴン"

### モンスターテンプレート
- common: スライム、バード
- rare: ドラゴン、ナイト
- epic: フェニックス
- legendary: 神

## 次のステップ
- ProgressManagerクラスの実装
- モンスター画像アセットの準備
- UIコンポーネントとの統合
- モンスター獲得演出の実装