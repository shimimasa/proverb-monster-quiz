# 2025-01-20 モンスター画像システム実装

## 実装内容

### 1. SVGベースのプロシージャル生成システム
- **ファイル**: `src/utils/monsterGenerator.ts`
- **機能**:
  - モンスターIDをシード値として決定論的に生成
  - 同じモンスターは常に同じ見た目
  - SVGで軽量かつスケーラブル

### 2. モンスター画像コンポーネント
- **ファイル**: `src/components/monster/MonsterImage.tsx`
- **機能**:
  - SVG生成とレンダリング
  - アニメーション効果（登場、ホバー、タップ）
  - エラーハンドリングとフォールバック

### 3. 既存コンポーネントの更新
- **MonsterCard.tsx**: MonsterImageコンポーネントに置き換え
- **MonsterReward.tsx**: 同様に更新

## デザインシステム

### カラーパレット
コンテンツタイプ別のテーマカラー：

#### ことわざ（proverb）
- **プライマリ**: 緑系（#2E7D32 〜 #66BB6A）
- **セカンダリ**: 薄緑系（#81C784 〜 #E8F5E9）
- **アクセント**: 赤、黄、緑

#### 慣用句（idiom）
- **プライマリ**: 青系（#1565C0 〜 #42A5F5）
- **セカンダリ**: 薄青系（#64B5F6 〜 #E3F2FD）
- **アクセント**: 赤、黄、緑

#### 四字熟語（four_character_idiom）
- **プライマリ**: 紫系（#6A1B9A 〜 #AB47BC）
- **セカンダリ**: 薄紫系（#BA68C8 〜 #F3E5F5）
- **アクセント**: 赤、黄、緑

### 形状パターン
レアリティ別の基本形状：

#### Common（コモン）
- 円（circle）
- 四角（square）
- 三角（triangle）

#### Rare（レア）
- 星（star）
- 六角形（hexagon）
- ひし形（diamond）

#### Epic（エピック）
- 八角形（octagon）
- ハート（heart）
- 雲（cloud）

#### Legendary（レジェンダリー）
- ドラゴン型
- フェニックス型
- ユニコーン型（未実装）

### パーツシステム

#### 目のバリエーション
- **Common**: ドット、丸
- **Rare**: 星、ハート
- **Epic**: キラキラ、炎
- **Legendary**: 銀河、虹

#### 口のバリエーション
- **Common**: 笑顔、普通
- **Rare**: にっこり、舌出し
- **Epic**: 牙、魔法
- **Legendary**: 宇宙、エレメンタル

#### アクセサリー
- **Common**: なし
- **Rare**: 帽子、リボン
- **Epic**: 王冠、翼
- **Legendary**: オーラ、光輪、星座

## 技術的な詳細

### シード値による決定論的生成
```typescript
function seededRandom(seed: string, index: number): number {
  const str = seed + index.toString();
  let hash = 0;
  for (let i = 0; i < str.length; i++) {
    const char = str.charCodeAt(i);
    hash = ((hash << 5) - hash) + char;
    hash = hash & hash;
  }
  return Math.abs(hash) / 2147483647;
}
```

### SVGパス生成
各形状は数学的に計算されたSVGパスで描画：
- 円：楕円弧を使用
- 星：10個の頂点を交互に配置
- ハート：ベジェ曲線で描画

### アニメーション
- **初期登場**: スケール0→1、回転-180度→0度
- **ホバー**: スケール1.1倍、左右に揺れる
- **タップ**: スケール0.9倍
- **レジェンダリー**: 光るパーティクル効果

## 実装の成果

1. **ユニークなビジュアル**
   - 各モンスターが固有の見た目を持つ
   - コンテンツタイプとレアリティが視覚的に判別可能

2. **高パフォーマンス**
   - SVGベースで軽量
   - プロシージャル生成で画像ファイル不要
   - スケーラブル（どのサイズでも綺麗）

3. **拡張性**
   - 新しい形状、パーツ、エフェクトの追加が容易
   - カラーパレットの調整が簡単

4. **一貫性**
   - 同じモンスターは常に同じ見た目
   - デザインシステムによる統一感

## 次のステップ

1. **追加のモンスタータイプ**
   - より複雑な形状の実装
   - 季節限定モンスターなど

2. **アニメーション強化**
   - 待機モーション
   - 獲得時の特別演出
   - パーティクルエフェクトの追加

3. **カスタマイズ機能**
   - プレイヤーによるカラー変更
   - アクセサリーの着せ替え

## まとめ

SVGベースのプロシージャル生成システムにより、無限のバリエーションを持つモンスターを実現しました。各モンスターはコンテンツタイプとレアリティに基づいて自動的にデザインされ、プレイヤーに視覚的な楽しみを提供します。