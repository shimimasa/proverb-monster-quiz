import{r as e,j as s,A as t,m as a}from"./chunk-DQeWIckh.js";import{u as l,d as n,a as r,c as i,r as c,p as d,q as x,n as o,W as m,X as g,R as h,Y as p,V as u}from"./index-DDmePrOZ.js";import"./chunk-BI3NJeJA.js";import"./chunk-MJnNx1Rr.js";import"./chunk-BGx2W5xE.js";const j=({onNavigate:j})=>{const{progressManager:b,monsterManager:y,localStorageManager:N}=l(),[f,v]=e.useState("settings"),[w,k]=e.useState(localStorage.getItem("playerName")||""),C=b.getSettings(),S=b.getProgressStats(),P=b.getProgress().achievements,A=e=>{const s=C.contentTypes,t=s.includes(e)?s.filter(s=>s!==e):[...s,e];t.length>0&&b.updateSettings({contentTypes:t})};return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-md p-2",children:s.jsxs("div",{className:"flex space-x-2",children:[s.jsxs("button",{onClick:()=>v("settings"),className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 rounded-lg transition-colors "+("settings"===f?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[s.jsx(n,{}),s.jsx("span",{children:"設定"})]}),s.jsxs("button",{onClick:()=>v("stats"),className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 rounded-lg transition-colors "+("stats"===f?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[s.jsx(r,{}),s.jsx("span",{children:"統計"})]}),s.jsxs("button",{onClick:()=>v("achievements"),className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 rounded-lg transition-colors "+("achievements"===f?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[s.jsx(i,{}),s.jsx("span",{children:"実績"})]})]})}),s.jsxs(t,{mode:"wait",children:["settings"===f&&s.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"bg-white rounded-lg shadow-md p-6",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:[s.jsx(n,{className:"inline mr-2"}),"設定"]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"プレイヤー名"}),s.jsx("input",{type:"text",value:w,onChange:e=>{return s=e.target.value,k(s),void localStorage.setItem("playerName",s);var s},placeholder:"名前を入力してください",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"ランキングに表示される名前です"})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"難易度"}),s.jsx("div",{className:"space-y-2",children:["小学生","中学生","高校生"].map(e=>s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",name:"difficulty",value:e,checked:C.difficulty===e,onChange:()=>{return s=e,void b.updateSettings({difficulty:s});var s},className:"w-4 h-4 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"ml-2 text-gray-700",children:e})]},e))})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"出題内容"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:C.contentTypes.includes("proverb"),onChange:()=>A("proverb"),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),s.jsx("span",{className:"ml-2 text-gray-700",children:"ことわざ"})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:C.contentTypes.includes("idiom"),onChange:()=>A("idiom"),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),s.jsx("span",{className:"ml-2 text-gray-700",children:"慣用句"})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:C.contentTypes.includes("four_character_idiom"),onChange:()=>A("four_character_idiom"),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),s.jsx("span",{className:"ml-2 text-gray-700",children:"四字熟語"})]})]})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"サウンド"}),s.jsxs("label",{className:"flex items-center mb-4",children:[s.jsx("input",{type:"checkbox",checked:C.soundEnabled,onChange:()=>{b.updateSettings({soundEnabled:!C.soundEnabled})},className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),s.jsx("span",{className:"ml-2 text-gray-700",children:"効果音を有効にする"})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("span",{className:"text-gray-600",children:"音量:"}),s.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:C.effectsVolume,onChange:e=>{return s=parseFloat(e.target.value),void b.updateSettings({effectsVolume:s});var s},disabled:!C.soundEnabled,className:"flex-1"}),s.jsxs("span",{className:"text-gray-600 w-12 text-right",children:[Math.round(100*C.effectsVolume),"%"]})]})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"データ管理"}),s.jsxs("div",{className:"space-y-3",children:[j&&s.jsxs("button",{onClick:()=>j("export"),className:"flex items-center space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[s.jsx(c,{}),s.jsx("span",{children:"詳細なデータエクスポート"})]}),s.jsxs("button",{onClick:async()=>{try{const e=await N.exportAllData(),s=new Blob([e],{type:"application/json"}),t=URL.createObjectURL(s),a=document.createElement("a");a.href=t,a.download=`kotodama-monster-backup-${(new Date).toISOString().split("T")[0]}.json`,a.click(),URL.revokeObjectURL(t)}catch(e){alert("データのエクスポートに失敗しました。")}},className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[s.jsx(d,{}),s.jsx("span",{children:"バックアップをダウンロード"})]}),s.jsxs("label",{className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors cursor-pointer",children:[s.jsx(x,{}),s.jsx("span",{children:"バックアップから復元"}),s.jsx("input",{type:"file",accept:".json",onChange:async e=>{const s=e.target.files?.[0];if(s)try{const e=await s.text();await N.importAllData(e),alert("データのインポートに成功しました。"),window.location.reload()}catch(t){alert("データのインポートに失敗しました。ファイルが正しいか確認してください。")}},className:"hidden"})]})]})]}),s.jsxs("div",{className:"border-t pt-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-red-600 mb-3",children:"危険な操作"}),s.jsxs("button",{onClick:()=>{window.confirm("本当に進捗をリセットしますか？この操作は取り消せません。")&&(b.resetProgress(),y.resetCollection(),window.location.reload())},className:"flex items-center space-x-2 px-6 py-2 bg-red-600 text-white font-medium rounded-lg hover:bg-red-700 transition-colors",children:[s.jsx(o,{}),s.jsx("span",{children:"進捗をリセット"})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"すべての進捗、獲得したモンスター、実績がリセットされます。"})]})]},"settings"),"stats"===f&&s.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"bg-white rounded-lg shadow-md p-6",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:[s.jsx(r,{className:"inline mr-2"}),"統計情報"]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[s.jsx(m,{className:"text-3xl text-blue-500 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-gray-600",children:"総問題数"}),s.jsx("p",{className:"text-2xl font-bold text-gray-800",children:b.getProgress().totalQuestions})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[s.jsx(g,{className:"text-3xl text-green-500 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-gray-600",children:"正解率"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-800",children:[S.accuracy.toFixed(1),"%"]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[s.jsx(h,{className:"text-3xl text-orange-500 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-gray-600",children:"平均ストリーク"}),s.jsx("p",{className:"text-2xl font-bold text-gray-800",children:S.averageStreak.toFixed(1)})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[s.jsx(p,{className:"text-3xl text-purple-500 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-gray-600",children:"1日の問題数"}),s.jsx("p",{className:"text-2xl font-bold text-gray-800",children:S.questionsPerDay.toFixed(1)})]})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"レベル進捗"}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:"text-gray-600",children:"現在のレベル"}),s.jsxs("span",{className:"text-xl font-bold text-blue-600",children:["Lv.",b.getProgress().level]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:s.jsx(a.div,{className:"h-full bg-gradient-to-r from-blue-400 to-blue-600",initial:{width:0},animate:{width:`${S.levelProgress.percentage}%`},transition:{duration:.5}})}),s.jsxs("div",{className:"flex justify-between items-center mt-2 text-sm text-gray-600",children:[s.jsxs("span",{children:[S.levelProgress.current," EXP"]}),s.jsxs("span",{children:["次のレベルまで ",S.levelProgress.required-S.levelProgress.current," EXP"]})]})]})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"コンテンツタイプ別統計"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsx("span",{className:"text-gray-700",children:"お気に入りのタイプ"}),s.jsxs("span",{className:"font-semibold text-gray-800",children:["proverb"===S.favoriteContentType&&"ことわざ","idiom"===S.favoriteContentType&&"慣用句","four_character_idiom"===S.favoriteContentType&&"四字熟語"]})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsx("span",{className:"text-gray-700",children:"最高ストリーク"}),s.jsxs("span",{className:"font-semibold text-gray-800",children:[S.bestStreak,"連続"]})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsx("span",{className:"text-gray-700",children:"1日あたりの問題数"}),s.jsxs("span",{className:"font-semibold text-gray-800",children:[S.questionsPerDay.toFixed(1),"問"]})]})]})]})]},"stats"),"achievements"===f&&s.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"bg-white rounded-lg shadow-md p-6",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:[s.jsx(i,{className:"inline mr-2"}),"実績"]}),s.jsx("div",{className:"space-y-4",children:P.map(e=>s.jsxs(a.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"p-4 rounded-lg border-2 "+(e.unlockedAt?"bg-yellow-50 border-yellow-300":"bg-gray-50 border-gray-200"),children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[s.jsx("span",{className:"text-2xl "+(e.unlockedAt?"":"grayscale opacity-50"),children:e.icon}),s.jsx("h3",{className:"font-semibold "+(e.unlockedAt?"text-gray-800":"text-gray-500"),children:e.name})]}),s.jsx("p",{className:"text-sm "+(e.unlockedAt?"text-gray-600":"text-gray-400"),children:e.description}),e.unlockedAt&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s.jsx(u,{className:"inline mr-1"}),new Date(e.unlockedAt).toLocaleDateString("ja-JP"),"に獲得"]})]}),e.unlockedAt&&s.jsx(g,{className:"text-green-500 text-xl ml-4"})]}),!e.unlockedAt&&e.id.includes("correct")&&s.jsx("div",{className:"mt-3",children:s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:s.jsx("div",{className:"h-full bg-gray-400",style:{width:`${Math.min(b.getProgress().correctAnswers/parseInt(e.id.split("_").pop()||"0")*100,100)}%`}})})})]},e.id))}),s.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-700",children:"獲得済み実績"}),s.jsxs("span",{className:"font-bold text-lg text-gray-800",children:[P.filter(e=>e.unlockedAt).length," / ",P.length]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden mt-2",children:s.jsx(a.div,{className:"h-full bg-gradient-to-r from-yellow-400 to-yellow-600",initial:{width:0},animate:{width:P.filter(e=>e.unlockedAt).length/P.length*100+"%"},transition:{duration:.5}})})]})]},"achievements")]})]})};export{j as SettingsScreen};
