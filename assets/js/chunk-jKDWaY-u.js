const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/QuizScreen.tsx-Cw3WEf7n.js","assets/js/chunk-DQeWIckh.js","assets/js/chunk-BI3NJeJA.js","assets/js/index-CyG_dUcQ.js","assets/js/chunk-MJnNx1Rr.js","assets/js/chunk-BGx2W5xE.js","assets/css/index-CrvRF-GB.css","assets/js/chunk-WKCWkKrv.js","assets/js/MonsterCollection.tsx-CRjjwp5k.js","assets/js/SettingsScreen.tsx-BbnZeBNr.js","assets/js/RankingScreen.tsx-DNGv-ouF.js","assets/js/StatsScreen.tsx-BN8lOb-I.js","assets/js/chunk-C7hMPJIR.js","assets/js/ExportScreen.tsx-CbNOFR4v.js"])))=>i.map(i=>d[i]);
import{u as e,F as t,a as s,b as a,c as l,d as i,e as n,f as r,g as c,h as o,i as d,j as x,k as m,l as u,m as p,n as h,o as g,p as j,q as f,r as y,s as b,t as v,v as N,w,x as _,y as C,z as k,A as S,B as E,C as R,D as A,E as L,G as D,H as T,I as M,J as O,K as $,L as z,M as I,N as P,O as F,P as V,Q as U,_ as q}from"./index-CyG_dUcQ.js";import{r as W,j as H,m as G,A as B}from"./chunk-DQeWIckh.js";const X={ARROW_UP:"ArrowUp",ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",HOME:"Home",END:"End"},J=(e,t="polite")=>{const s=document.createElement("div");s.setAttribute("role","status"),s.setAttribute("aria-live",t),s.setAttribute("aria-atomic","true"),s.style.position="absolute",s.style.left="-10000px",s.style.width="1px",s.style.height="1px",s.style.overflow="hidden",s.textContent=e,document.body.appendChild(s),setTimeout(()=>{document.body.removeChild(s)},1e3)},Q=({currentPage:n,onNavigate:r})=>{const{progressManager:c}=e(),o=c.getProgress(),d=W.useRef(null),x=[{id:"quiz",icon:a,label:"クイズ"},{id:"collection",icon:l,label:"コレクション"},{id:"ranking",icon:l,label:"ランキング"},{id:"stats",icon:s,label:"統計"},{id:"settings",icon:i,label:"設定"}];return W.useEffect(()=>{const e=e=>{if(!d.current)return;const t=d.current.querySelectorAll("button:not([disabled])"),s=Array.from(t).findIndex(e=>e===document.activeElement);switch(e.key){case X.ARROW_LEFT:e.preventDefault(),s>0&&t[s-1].focus();break;case X.ARROW_RIGHT:e.preventDefault(),s<t.length-1&&t[s+1].focus();break;case X.HOME:e.preventDefault(),t[0]?.focus();break;case X.END:e.preventDefault(),t[t.length-1]?.focus()}};return d.current?.addEventListener("keydown",e),()=>d.current?.removeEventListener("keydown",e)},[]),H.jsx("header",{className:"bg-white shadow-md",role:"banner",children:H.jsx("div",{className:"container mx-auto px-4 py-3",children:H.jsxs("div",{className:"flex items-center justify-between",children:[H.jsxs("div",{className:"flex items-center space-x-2",children:[H.jsx("div",{className:"text-3xl","aria-hidden":"true",children:"📚"}),H.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-800",children:"ことだまモンスター"})]}),H.jsxs("div",{className:"hidden md:flex items-center space-x-4 text-sm",role:"region","aria-label":"ユーザー統計",children:[H.jsxs("div",{className:"flex items-center space-x-1",children:[H.jsx(t,{className:"text-yellow-500","aria-hidden":"true"}),H.jsxs("span",{className:"font-medium",children:["Lv.",o.level]})]}),H.jsxs("div",{className:"flex items-center space-x-1",children:[H.jsx(s,{className:"text-green-500","aria-hidden":"true"}),H.jsxs("span",{className:"font-medium",children:[o.totalCorrect,"問正解"]})]})]}),H.jsx("nav",{ref:d,className:"hidden md:flex items-center space-x-6",role:"navigation","aria-label":"メインナビゲーション",children:x.map(({id:e,icon:t,label:s})=>H.jsxs("button",{onClick:()=>r?.(e),className:"flex items-center space-x-2 transition-colors "+(n===e?"text-blue-600 font-medium":"text-gray-600 hover:text-blue-600"),"aria-current":n===e?"page":void 0,"aria-label":s,children:[H.jsx(t,{"aria-hidden":"true"}),H.jsx("span",{children:s})]},e))})]})})})},K=({onSuccess:e,onCancel:t})=>{const{login:s}=n(),[a,l]=W.useState(""),[i,d]=W.useState(!1),[x,m]=W.useState(""),[u,p]=W.useState(!1);return H.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:H.jsxs(G.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:[H.jsxs("div",{className:"flex items-center mb-6",children:[H.jsx(r,{className:"text-3xl text-purple-600 mr-3"}),H.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"管理者ログイン"})]}),H.jsxs("form",{onSubmit:async t=>{t.preventDefault(),m(""),p(!0),await new Promise(e=>setTimeout(e,500));const i=s(a);p(!1),i?e():(m("パスワードが正しくありません"),l(""))},className:"space-y-4",children:[H.jsxs("div",{children:[H.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"パスワード"}),H.jsxs("div",{className:"relative",children:[H.jsx("input",{type:i?"text":"password",id:"password",value:a,onChange:e=>l(e.target.value),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent pr-10",placeholder:"パスワードを入力",required:!0,disabled:u,autoFocus:!0}),H.jsx("button",{type:"button",onClick:()=>d(!i),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",tabIndex:-1,children:i?H.jsx(c,{}):H.jsx(o,{})})]})]}),x&&H.jsx(G.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:x}),H.jsxs("div",{className:"flex space-x-3 pt-2",children:[H.jsx("button",{type:"submit",disabled:u||!a,className:"flex-1 bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:u?"ログイン中...":"ログイン"}),H.jsx("button",{type:"button",onClick:t,disabled:u,className:"flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors",children:"キャンセル"})]})]}),H.jsx("div",{className:"mt-4 text-xs text-gray-500 text-center",children:"デフォルトパスワード: admin123"})]})})},Y=({initialData:e,onSubmit:t,onCancel:s,errors:a=[],isLoading:l=!1})=>{const[i,n]=W.useState({text:"",reading:"",meaning:"",difficulty:"小学生",example_sentence:"",type:"proverb",...e}),r=e=>a.find(t=>t.field===e)?.message,c=(e,t)=>{n(s=>({...s,[e]:t}))};return H.jsxs("form",{onSubmit:e=>{e.preventDefault(),t(i)},className:"space-y-4",children:[H.jsxs("div",{children:[H.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["タイプ ",H.jsx("span",{className:"text-red-500",children:"*"})]}),H.jsxs("select",{value:i.type,onChange:e=>c("type",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500",disabled:l||!!e,children:[H.jsx("option",{value:"proverb",children:"ことわざ"}),H.jsx("option",{value:"four_character_idiom",children:"四字熟語"}),H.jsx("option",{value:"idiom",children:"慣用句"})]})]}),H.jsxs("div",{children:[H.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["proverb"===i.type?"ことわざ":"four_character_idiom"===i.type?"四字熟語":"慣用句",H.jsx("span",{className:"text-red-500",children:" *"})]}),H.jsx("input",{type:"text",value:i.text,onChange:e=>c("text",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 "+(r("text")?"border-red-500":""),placeholder:"例: 猿も木から落ちる",disabled:l}),r("text")&&H.jsx("p",{className:"text-red-500 text-sm mt-1",children:r("text")})]}),H.jsxs("div",{children:[H.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["読み方（ひらがな） ",H.jsx("span",{className:"text-red-500",children:"*"})]}),H.jsx("input",{type:"text",value:i.reading,onChange:e=>c("reading",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 "+(r("reading")?"border-red-500":""),placeholder:"例: さるもきからおちる",disabled:l}),r("reading")&&H.jsx("p",{className:"text-red-500 text-sm mt-1",children:r("reading")})]}),H.jsxs("div",{children:[H.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["意味 ",H.jsx("span",{className:"text-red-500",children:"*"})]}),H.jsx("textarea",{value:i.meaning,onChange:e=>c("meaning",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 "+(r("meaning")?"border-red-500":""),placeholder:"例: どんなに得意なことでも、時には失敗することがある",rows:3,disabled:l}),r("meaning")&&H.jsx("p",{className:"text-red-500 text-sm mt-1",children:r("meaning")})]}),H.jsxs("div",{children:[H.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["難易度 ",H.jsx("span",{className:"text-red-500",children:"*"})]}),H.jsxs("select",{value:i.difficulty,onChange:e=>c("difficulty",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500",disabled:l,children:[H.jsx("option",{value:"小学生",children:"小学生"}),H.jsx("option",{value:"中学生",children:"中学生"}),H.jsx("option",{value:"高校生",children:"高校生"})]})]}),H.jsxs("div",{children:[H.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"例文（任意）"}),H.jsx("textarea",{value:i.example_sentence||"",onChange:e=>c("example_sentence",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 "+(r("example_sentence")?"border-red-500":""),placeholder:"例: プロの料理人でも失敗することがある。猿も木から落ちるというものだ。",rows:2,disabled:l}),r("example_sentence")&&H.jsx("p",{className:"text-red-500 text-sm mt-1",children:r("example_sentence")})]}),H.jsxs("div",{className:"flex space-x-3 pt-4",children:[H.jsxs("button",{type:"submit",disabled:l,className:"flex-1 bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:[H.jsx(d,{}),H.jsx("span",{children:e?"更新":"追加"})]}),H.jsxs("button",{type:"button",onClick:s,disabled:l,className:"flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors flex items-center justify-center space-x-2",children:[H.jsx(x,{}),H.jsx("span",{children:"キャンセル"})]})]})]})},Z=({contents:e,onEdit:t,onDelete:s,isCustomContent:a=()=>!0})=>{const[l,i]=W.useState({type:"all",difficulty:"all",searchText:""}),[n,r]=W.useState(null),c=W.useMemo(()=>e.filter(e=>{if("all"!==l.type&&e.type!==l.type)return!1;if("all"!==l.difficulty&&e.difficulty!==l.difficulty)return!1;if(l.searchText){const t=l.searchText.toLowerCase();return e.text.toLowerCase().includes(t)||e.reading.toLowerCase().includes(t)||e.meaning.toLowerCase().includes(t)}return!0}),[e,l]),o=e=>{switch(e){case"小学生":return"bg-green-100 text-green-800";case"中学生":return"bg-yellow-100 text-yellow-800";case"高校生":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return H.jsxs("div",{className:"space-y-4",children:[H.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm space-y-3",children:[H.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[H.jsxs("div",{children:[H.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[H.jsx(m,{className:"inline mr-1"}),"タイプ"]}),H.jsxs("select",{value:l.type||"all",onChange:e=>i(t=>({...t,type:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500",children:[H.jsx("option",{value:"all",children:"すべて"}),H.jsx("option",{value:"proverb",children:"ことわざ"}),H.jsx("option",{value:"four_character_idiom",children:"四字熟語"}),H.jsx("option",{value:"idiom",children:"慣用句"})]})]}),H.jsxs("div",{children:[H.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[H.jsx(m,{className:"inline mr-1"}),"難易度"]}),H.jsxs("select",{value:l.difficulty||"all",onChange:e=>i(t=>({...t,difficulty:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500",children:[H.jsx("option",{value:"all",children:"すべて"}),H.jsx("option",{value:"小学生",children:"小学生"}),H.jsx("option",{value:"中学生",children:"中学生"}),H.jsx("option",{value:"高校生",children:"高校生"})]})]}),H.jsxs("div",{children:[H.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[H.jsx(u,{className:"inline mr-1"}),"検索"]}),H.jsx("input",{type:"text",value:l.searchText||"",onChange:e=>i(t=>({...t,searchText:e.target.value})),placeholder:"テキスト、読み、意味で検索",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500"})]})]}),H.jsxs("div",{className:"text-sm text-gray-600",children:["検索結果: ",c.length,"件"]})]}),H.jsx("div",{className:"space-y-2",children:H.jsx(B,{children:c.map(e=>{const s=a(e);return H.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-100},className:"bg-white p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow",children:H.jsxs("div",{className:"flex justify-between items-start",children:[H.jsxs("div",{className:"flex-1",children:[H.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[H.jsx("span",{className:"text-lg font-medium",children:e.text}),H.jsxs("span",{className:"text-sm text-gray-500",children:["(",e.reading,")"]}),H.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${o(e.difficulty)}`,children:e.difficulty}),H.jsx("span",{className:"text-xs bg-purple-100 text-purple-800 px-2 py-1 rounded-full",children:(l=e.type,{proverb:"ことわざ",four_character_idiom:"四字熟語",idiom:"慣用句"}[l])}),s&&H.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:"カスタム"})]}),H.jsx("p",{className:"text-gray-700",children:e.meaning}),e.example_sentence&&H.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["例: ",e.example_sentence]})]}),s&&H.jsxs("div",{className:"flex space-x-2 ml-4",children:[H.jsx("button",{onClick:()=>t(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"編集",children:H.jsx(p,{})}),H.jsx("button",{onClick:()=>r(e),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"削除",children:H.jsx(h,{})})]})]})},`${e.type}-${e.id}`);var l})})}),H.jsx(B,{children:n&&H.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:H.jsxs(G.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},className:"bg-white rounded-lg p-6 max-w-md w-full",children:[H.jsx("h3",{className:"text-lg font-bold mb-4",children:"削除の確認"}),H.jsx("p",{className:"mb-2",children:"以下のコンテンツを削除しますか？"}),H.jsx("p",{className:"font-medium mb-4",children:n.text}),H.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"この操作は取り消せません。"}),H.jsxs("div",{className:"flex space-x-3",children:[H.jsx("button",{onClick:()=>(s(n),void r(null)),className:"flex-1 bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 transition-colors",children:"削除する"}),H.jsx("button",{onClick:()=>r(null),className:"flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors",children:"キャンセル"})]})]})})})]})},ee=({onImport:e,onExport:t})=>{const[s,a]=W.useState("proverb"),[l,i]=W.useState(null),[n,r]=W.useState(!1),c=W.useRef(null),o=(e,t,s)=>{const a=new Blob([e],{type:s+";charset=utf-8"}),l=URL.createObjectURL(a),i=document.createElement("a");i.href=l,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(l)},d=e=>({proverb:"ことわざ",four_character_idiom:"四字熟語",idiom:"慣用句"}[e]);return H.jsxs("div",{className:"space-y-6",children:[H.jsxs("div",{children:[H.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"コンテンツタイプ"}),H.jsxs("select",{value:s,onChange:e=>a(e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500",children:[H.jsx("option",{value:"proverb",children:"ことわざ"}),H.jsx("option",{value:"four_character_idiom",children:"四字熟語"}),H.jsx("option",{value:"idiom",children:"慣用句"})]})]}),H.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[H.jsxs("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[H.jsx(g,{className:"mr-2"}),"CSVインポート"]}),H.jsxs("div",{className:"space-y-3",children:[H.jsxs("p",{className:"text-sm text-gray-600",children:["CSVファイルから",d(s),"データを一括インポートできます。"]}),H.jsxs("div",{className:"flex space-x-3",children:[H.jsxs("button",{onClick:()=>{o("テキスト,読み方,意味,難易度,例文\n猿も木から落ちる,さるもきからおちる,どんなに得意なことでも時には失敗することがある,小学生,プロの料理人でも失敗することがある。猿も木から落ちるというものだ。\n石の上にも三年,いしのうえにもさんねん,辛抱強く続ければ必ず成果が出る,小学生,最初は難しかったけど、石の上にも三年で上達した。","import_template.csv","text/csv")},className:"flex items-center space-x-2 px-4 py-2 bg-white border border-blue-300 text-blue-700 rounded-lg hover:bg-blue-50 transition-colors",children:[H.jsx(j,{}),H.jsx("span",{children:"テンプレートをダウンロード"})]}),H.jsxs("label",{className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors cursor-pointer",children:[H.jsx(f,{}),H.jsx("span",{children:"CSVファイルを選択"}),H.jsx("input",{ref:c,type:"file",accept:".csv",onChange:async t=>{const a=t.target.files?.[0];if(a){r(!0),i(null);try{const t=await a.text(),l=e(t,s);i(l)}catch(l){i({success:0,failed:1,errors:[{row:0,field:"file",message:"ファイルの読み込みに失敗しました"}]})}finally{r(!1),c.current&&(c.current.value="")}}},className:"hidden",disabled:n})]})]})]}),l&&H.jsxs(G.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-4 p-3 rounded-lg "+(0===l.failed?"bg-green-100":"bg-yellow-100"),children:[H.jsxs("p",{className:"font-medium",children:["インポート完了: 成功 ",l.success,"件 / 失敗 ",l.failed,"件"]}),l.errors.length>0&&H.jsxs("div",{className:"mt-2 text-sm",children:[H.jsx("p",{className:"font-medium text-red-700",children:"エラー詳細:"}),H.jsxs("ul",{className:"mt-1 space-y-1",children:[l.errors.slice(0,5).map((e,t)=>H.jsxs("li",{className:"text-red-600",children:["行",e.row,": ",e.field," - ",e.message]},t)),l.errors.length>5&&H.jsxs("li",{className:"text-gray-600",children:["他",l.errors.length-5,"件のエラー"]})]})]})]})]}),H.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[H.jsxs("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[H.jsx(y,{className:"mr-2"}),"JSONエクスポート"]}),H.jsxs("div",{className:"space-y-3",children:[H.jsx("p",{className:"text-sm text-gray-600",children:"カスタムコンテンツをJSON形式でエクスポートできます。"}),H.jsxs("div",{className:"flex space-x-3",children:[H.jsxs("button",{onClick:()=>{const e=t(s);o(e,`${s}_contents.json`,"application/json")},className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[H.jsx(j,{}),H.jsxs("span",{children:[d(s),"をエクスポート"]})]}),H.jsxs("button",{onClick:()=>{const e=t();o(e,"all_contents.json","application/json")},className:"flex items-center space-x-2 px-4 py-2 bg-white border border-green-300 text-green-700 rounded-lg hover:bg-green-50 transition-colors",children:[H.jsx(j,{}),H.jsx("span",{children:"すべてエクスポート"})]})]})]})]}),H.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg text-sm text-gray-600",children:[H.jsx("h4",{className:"font-bold mb-2",children:"CSVフォーマットについて"}),H.jsxs("ul",{className:"space-y-1 list-disc list-inside",children:[H.jsx("li",{children:"1行目はヘッダー行として扱われます"}),H.jsx("li",{children:"列の順序: テキスト, 読み方, 意味, 難易度, 例文（任意）"}),H.jsx("li",{children:"難易度は「小学生」「中学生」「高校生」のいずれか"}),H.jsx("li",{children:"カンマを含む場合は二重引用符で囲んでください"}),H.jsx("li",{children:"文字コードはUTF-8を推奨します"})]})]})]})},te=({onClose:t})=>{const{isAdmin:s,logout:a,adminManager:l}=n(),{contentManager:i}=e(),[r,c]=W.useState(!s),[o,d]=W.useState("list"),[m,u]=W.useState(null),[p,h]=W.useState([]),[j,f]=W.useState([]),[y,_]=W.useState(new Set);W.useEffect(()=>{C()},[]);const C=async()=>{await i.loadAllContent();const e=[...i.getAllContent("proverb"),...i.getAllContent("four_character_idiom"),...i.getAllContent("idiom")],t=l.getAllCustomContent(),s=new Set(t.map(e=>`${e.type}-${e.id}`)),a=new Map;e.forEach(e=>{const t=`${e.type}-${e.id}`;a.set(t,e)}),t.forEach(e=>{const t=`${e.type}-${e.id}`;a.set(t,e)}),f(Array.from(a.values())),_(s)},k=()=>{c(!1)};return r?H.jsx(K,{onSuccess:k,onCancel:t}):H.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:H.jsxs(G.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"bg-white rounded-lg shadow-xl w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[H.jsxs("div",{className:"bg-purple-600 text-white p-4 flex items-center justify-between",children:[H.jsxs("div",{className:"flex items-center space-x-3",children:[H.jsx(b,{className:"text-2xl"}),H.jsx("h2",{className:"text-xl font-bold",children:"管理者パネル"})]}),H.jsxs("div",{className:"flex items-center space-x-2",children:[H.jsxs("button",{onClick:()=>{a(),t()},className:"px-3 py-1 bg-purple-700 rounded hover:bg-purple-800 transition-colors flex items-center space-x-1",children:[H.jsx(v,{}),H.jsx("span",{children:"ログアウト"})]}),H.jsx("button",{onClick:t,className:"p-1 hover:bg-purple-700 rounded transition-colors",children:H.jsx(x,{className:"text-xl"})})]})]}),H.jsxs("div",{className:"bg-gray-100 px-4 py-2 flex space-x-2",children:[H.jsxs("button",{onClick:()=>{d("list"),u(null)},className:"px-4 py-2 rounded-lg transition-colors flex items-center space-x-2 "+("list"===o?"bg-white text-purple-600 shadow-sm":"text-gray-600 hover:bg-gray-200"),children:[H.jsx(N,{}),H.jsx("span",{children:"コンテンツ一覧"})]}),H.jsxs("button",{onClick:()=>{d("add"),u(null)},className:"px-4 py-2 rounded-lg transition-colors flex items-center space-x-2 "+("add"===o?"bg-white text-purple-600 shadow-sm":"text-gray-600 hover:bg-gray-200"),children:[H.jsx(w,{}),H.jsx("span",{children:m?"編集":"新規追加"})]}),H.jsxs("button",{onClick:()=>d("import"),className:"px-4 py-2 rounded-lg transition-colors flex items-center space-x-2 "+("import"===o?"bg-white text-purple-600 shadow-sm":"text-gray-600 hover:bg-gray-200"),children:[H.jsx(g,{}),H.jsx("span",{children:"インポート/エクスポート"})]})]}),H.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:H.jsxs(B,{mode:"wait",children:["list"===o&&H.jsx(G.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},children:H.jsx(Z,{contents:j,onEdit:e=>{u(e),d("add")},onDelete:e=>{l.deleteContent(e.id,e.type)&&C()},isCustomContent:e=>y.has(`${e.type}-${e.id}`)})},"list"),"add"===o&&H.jsx(G.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},children:H.jsxs("div",{className:"max-w-2xl mx-auto",children:[H.jsx("h3",{className:"text-lg font-bold mb-4",children:m?"コンテンツ編集":"新規コンテンツ追加"}),H.jsx(Y,{initialData:m||void 0,onSubmit:m?e=>{const t=l.updateContent(e);t.success?(u(null),d("list"),h([]),C()):h(t.errors||[])}:e=>{const t=l.addContent(e);t.success?(d("list"),h([]),C()):h(t.errors||[])},onCancel:()=>{d("list"),u(null),h([])},errors:p})]})},"add"),"import"===o&&H.jsx(G.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},children:H.jsxs("div",{className:"max-w-2xl mx-auto",children:[H.jsx("h3",{className:"text-lg font-bold mb-4",children:"インポート/エクスポート"}),H.jsx(ee,{onImport:(e,t)=>{const s=l.importCSV(e,t);return s.success>0&&C(),s},onExport:e=>l.exportCustomContent(e)})]})},"import")]})})]})})},se=({currentPage:e,onNavigate:t})=>{const r=W.useRef(null),{isAdmin:c}=n(),[o,d]=W.useState(!1),[x,m]=W.useState(0),u=[{id:"quiz",icon:a,label:"クイズ"},{id:"collection",icon:l,label:"モンスター"},{id:"ranking",icon:l,label:"ランキング"},{id:"stats",icon:s,label:"統計"},{id:"settings",icon:i,label:"設定"}];W.useEffect(()=>{const e=e=>{if(!r.current)return;const t=r.current.querySelectorAll("button:not([disabled])"),s=Array.from(t).findIndex(e=>e===document.activeElement);switch(e.key){case X.ARROW_LEFT:e.preventDefault(),s>0?t[s-1].focus():t[t.length-1].focus();break;case X.ARROW_RIGHT:e.preventDefault(),s<t.length-1?t[s+1].focus():t[0].focus();break;case X.HOME:e.preventDefault(),t[0]?.focus();break;case X.END:e.preventDefault(),t[t.length-1]?.focus()}};return r.current?.addEventListener("keydown",e),()=>r.current?.removeEventListener("keydown",e)},[]);return H.jsxs(H.Fragment,{children:[H.jsxs("footer",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200",role:"contentinfo",children:[H.jsxs("nav",{ref:r,className:"flex items-center justify-around py-2",role:"navigation","aria-label":"モバイルナビゲーション",children:[u.map(({id:s,icon:a,label:l})=>H.jsxs("button",{onClick:()=>t?.(s),className:"flex flex-col items-center p-2 transition-colors "+(e===s?"text-blue-600":"text-gray-500 hover:text-gray-700"),"aria-current":e===s?"page":void 0,"aria-label":l,children:[H.jsx(a,{className:"text-xl mb-1","aria-hidden":"true"}),H.jsx("span",{className:"text-xs",children:l})]},s)),c&&H.jsxs("button",{onClick:()=>d(!0),className:"flex flex-col items-center p-2 transition-colors text-purple-600 hover:text-purple-700","aria-label":"管理者パネル",children:[H.jsx(b,{className:"text-xl mb-1","aria-hidden":"true"}),H.jsx("span",{className:"text-xs",children:"管理者"})]})]}),H.jsx("div",{className:"text-center py-1 border-t border-gray-100",children:H.jsx("button",{onClick:()=>{m(e=>e+1),x>=4&&(d(!0),m(0)),setTimeout(()=>m(0),3e3)},className:"text-xs text-gray-400 hover:text-gray-600 transition-colors",children:"© 2024 ことだまモンスタークイズ"})})]}),o&&H.jsx(te,{onClose:()=>d(!1)})]})},ae={network:{icon:E,title:"ネットワークエラー",message:"インターネット接続を確認してください。",color:"text-blue-600",bgColor:"bg-blue-100"},data:{icon:S,title:"データ読み込みエラー",message:"データの読み込みに失敗しました。",color:"text-purple-600",bgColor:"bg-purple-100"},storage:{icon:k,title:"ストレージエラー",message:"ストレージの容量が不足している可能性があります。",color:"text-orange-600",bgColor:"bg-orange-100"},validation:{icon:C,title:"データ検証エラー",message:"データの形式が正しくありません。",color:"text-red-600",bgColor:"bg-red-100"},general:{icon:_,title:"エラーが発生しました",message:"予期しないエラーが発生しました。",color:"text-gray-600",bgColor:"bg-gray-100"}},le=({type:e,message:t,onRetry:s,className:a=""})=>{const l=ae[e],i=l.icon;return H.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`bg-white rounded-lg shadow-md p-6 ${a}`,children:H.jsxs("div",{className:"text-center",children:[H.jsx("div",{className:`inline-flex items-center justify-center w-16 h-16 ${l.bgColor} rounded-full mb-4`,children:H.jsx(i,{className:`text-3xl ${l.color}`})}),H.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:l.title}),H.jsx("p",{className:"text-gray-600 mb-6",children:t||l.message}),s&&H.jsxs("button",{onClick:s,className:"inline-flex items-center space-x-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[H.jsx(R,{}),H.jsx("span",{children:"再試行"})]})]})})},ie=e=>{switch(e){case"first_correct":return H.jsx(M,{className:"text-2xl"});case"streak_5":case"streak_10":case"streak_20":return H.jsx(T,{className:"text-2xl"});case"correct_10":case"correct_50":return H.jsx(t,{className:"text-2xl"});case"correct_100":case"correct_500":return H.jsx(l,{className:"text-2xl"});case"accuracy_90":return H.jsx(D,{className:"text-2xl"});case"monsters_10":case"monsters_50":return H.jsx(L,{className:"text-2xl"});default:return H.jsx(A,{className:"text-2xl"})}},ne=e=>e.includes("500")||e.includes("50")?"from-yellow-400 to-orange-500":e.includes("100")||e.includes("20")?"from-purple-400 to-pink-500":e.includes("accuracy")?"from-blue-400 to-cyan-500":e.includes("monsters")?"from-green-400 to-emerald-500":"from-gray-400 to-gray-600",re=({achievements:e,onClear:t})=>{const[s,a]=W.useState([]),[l,i]=W.useState([]);return W.useEffect(()=>{const t=e.map(e=>({achievement:e,id:`${e.id}-${Date.now()}`}));t.length>0&&a(e=>[...e,...t])},[e]),W.useEffect(()=>{if(s.length>0&&l.length<3){const e=s[0];a(e=>e.slice(1)),i(t=>[...t,e]);const l=setTimeout(()=>{i(t=>t.filter(t=>t.id!==e.id)),t(e.achievement.id)},5e3);return()=>clearTimeout(l)}},[s,l,t]),H.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2 pointer-events-none",children:H.jsx(B,{children:l.map((e,t)=>H.jsx(G.div,{initial:{x:300,opacity:0},animate:{x:0,opacity:1},exit:{x:300,opacity:0},transition:{type:"spring",stiffness:200,damping:20,delay:.1*t},className:"pointer-events-auto",children:H.jsxs("div",{className:"relative overflow-hidden bg-white rounded-lg shadow-lg p-4 min-w-[320px] max-w-md",children:[H.jsx("div",{className:`absolute inset-0 bg-gradient-to-r ${ne(e.achievement.id)} opacity-10`}),H.jsxs("div",{className:"relative flex items-center gap-4",children:[H.jsx("div",{className:`flex-shrink-0 w-12 h-12 rounded-full bg-gradient-to-r ${ne(e.achievement.id)} flex items-center justify-center text-white shadow-md`,children:ie(e.achievement.id)}),H.jsxs("div",{className:"flex-1",children:[H.jsx("h3",{className:"font-bold text-gray-800 text-sm",children:"実績を獲得しました！"}),H.jsx("p",{className:"text-gray-600 font-medium",children:e.achievement.name}),H.jsx("p",{className:"text-gray-500 text-sm mt-0.5",children:e.achievement.description})]})]}),H.jsx(G.div,{className:"absolute bottom-0 left-0 h-1 bg-gradient-to-r from-green-400 to-green-600",initial:{width:"100%"},animate:{width:"0%"},transition:{duration:5,ease:"linear"}})]})},e.id))})})},ce=({levelUpResult:e,onClose:s})=>{const[a,i]=W.useState(0),[n,r]=W.useState([]),[c,o]=W.useState(null);W.useEffect(()=>{if(!e)return;const t=e.previousLevel,s=e.newLevel,a=(s-t)/20;let l=0;const n=setInterval(()=>{l++,l>=20?(i(s),clearInterval(n)):i(Math.floor(t+a*l))},50);return()=>clearInterval(n)},[e]),W.useEffect(()=>{if(!e)return;const t=[],s=["#FFD700","#FFA500","#FF69B4","#00CED1","#9370DB"];for(let e=0;e<50;e++)t.push({id:e,x:100*Math.random(),y:100*Math.random(),vx:2*(Math.random()-.5),vy:2*(Math.random()-.5),size:20*Math.random()+10,color:s[Math.floor(Math.random()*s.length)]});r(t)},[e]),W.useEffect(()=>{if(!e)return;const t=setTimeout(()=>{s()},5e3);return o(t),()=>{t&&clearTimeout(t)}},[e,s]);return e?H.jsx(B,{children:H.jsxs(G.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center",onClick:()=>{c&&clearTimeout(c),s()},children:[H.jsx(G.div,{initial:{opacity:0},animate:{opacity:.8},exit:{opacity:0},className:"absolute inset-0 bg-black"}),H.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:n.map(e=>H.jsx(G.div,{className:"absolute rounded-full",style:{width:e.size,height:e.size,backgroundColor:e.color,left:`${e.x}%`,top:`${e.y}%`},animate:{x:500*e.vx,y:500*e.vy,opacity:[1,0]},transition:{duration:3,ease:"easeOut"}},e.id))}),H.jsxs(G.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},exit:{scale:0,rotate:180},transition:{type:"spring",stiffness:200,damping:20},className:"relative bg-gradient-to-br from-purple-600 to-pink-600 rounded-3xl p-8 text-white max-w-md w-full mx-4 shadow-2xl",children:[H.jsx("div",{className:"absolute -top-6 left-1/2 transform -translate-x-1/2",children:H.jsx(G.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"bg-yellow-400 rounded-full p-3",children:H.jsx(t,{className:"text-3xl text-white"})})}),H.jsxs(G.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},className:"text-center mb-6",children:[H.jsxs("h2",{className:"text-4xl font-bold mb-2 flex items-center justify-center gap-2",children:[H.jsx(O,{className:"text-yellow-300"}),"LEVEL UP!"]}),H.jsx("div",{className:"text-6xl font-bold",children:H.jsx(G.span,{initial:{scale:1.5,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:300},children:a||e.newLevel},a)})]}),H.jsxs(G.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5},className:"space-y-3 mb-6",children:[H.jsxs("div",{className:"flex items-center justify-between bg-white/20 rounded-lg p-3",children:[H.jsxs("span",{className:"flex items-center gap-2",children:[H.jsx(l,{className:"text-yellow-300"}),"獲得経験値"]}),H.jsxs("span",{className:"font-bold text-xl",children:["+",e.experienceGained," EXP"]})]}),H.jsxs("div",{className:"flex items-center justify-between bg-white/20 rounded-lg p-3",children:[H.jsxs("span",{className:"flex items-center gap-2",children:[H.jsx($,{className:"text-cyan-300"}),"累計経験値"]}),H.jsxs("span",{className:"font-bold text-xl",children:[e.totalExperience," EXP"]})]})]}),e.newLevel%5==0&&H.jsx(G.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.7},className:"text-center text-sm bg-yellow-400/30 rounded-lg p-3",children:"🎉 新しい実績が解放されました！"}),H.jsx(G.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"text-center text-xs mt-4 text-white/60",children:"クリックして続ける"})]})]})}):null},oe=({notification:e,onClose:t})=>{if(!e)return null;return H.jsx(B,{children:H.jsxs(G.div,{initial:{x:300,opacity:0},animate:{x:0,opacity:1},exit:{x:300,opacity:0},transition:{type:"spring",damping:25},className:"fixed top-20 right-4 z-50",children:[H.jsxs("div",{className:`${(()=>{switch(e.type){case"first_place":return"bg-gradient-to-r from-yellow-400 to-orange-400";case"top_3":return"bg-gradient-to-r from-orange-400 to-red-400";case"top_10":return"bg-gradient-to-r from-blue-500 to-purple-500";case"rank_up":return"bg-gradient-to-r from-green-500 to-teal-500";default:return"bg-gradient-to-r from-purple-500 to-pink-500"}})()} text-white rounded-xl shadow-2xl p-6 min-w-[320px]`,children:[H.jsxs("div",{className:"flex items-start space-x-4",children:[H.jsx(G.div,{animate:{rotate:[0,-10,10,-10,0],scale:[1,1.1,1]},transition:{duration:.5,delay:.3},children:(()=>{switch(e.type){case"first_place":return H.jsx(P,{className:"text-yellow-400 text-3xl"});case"top_3":return H.jsx(I,{className:"text-orange-400 text-3xl"});case"top_10":return H.jsx(l,{className:"text-blue-600 text-3xl"});case"rank_up":return H.jsx(z,{className:"text-green-500 text-3xl"});default:return H.jsx(l,{className:"text-purple-600 text-3xl"})}})()}),H.jsxs("div",{className:"flex-1",children:[H.jsx("h3",{className:"text-lg font-bold mb-1",children:"ランキング更新！"}),H.jsx("p",{className:"text-sm opacity-90 mb-2",children:e.message}),H.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[(()=>{switch(e.category){case"daily":return H.jsx(U,{className:"text-sm"});case"weekly":return H.jsx(V,{className:"text-sm"});case"all_time":return H.jsx(F,{className:"text-sm"})}})(),H.jsx("span",{className:"font-semibold",children:e.previousRank&&e.previousRank>0?`${e.previousRank}位 → ${e.newRank}位`:`${e.newRank}位`})]})]}),H.jsx("button",{onClick:t,className:"text-white/70 hover:text-white transition-colors",children:"✕"})]}),H.jsx(G.div,{initial:{scaleX:0},animate:{scaleX:1},transition:{duration:5,ease:"linear"},onAnimationComplete:t,className:"absolute bottom-0 left-0 right-0 h-1 bg-white/30 origin-left"})]}),H.jsx("div",{className:"absolute inset-0 -z-10",children:[...Array(6)].map((e,t)=>H.jsx(G.div,{initial:{opacity:0,scale:0},animate:{opacity:[0,1,0],scale:[0,1.5,0],x:100*Math.random()-50,y:100*Math.random()-50},transition:{duration:2,delay:.2*t,repeat:1/0,repeatDelay:1},className:"absolute w-2 h-2 bg-white rounded-full",style:{left:100*Math.random()+"%",top:100*Math.random()+"%"}},t))})]})})},de=W.lazy(()=>q(()=>import("./QuizScreen.tsx-Cw3WEf7n.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])).then(e=>({default:e.QuizScreen}))),xe=W.lazy(()=>q(()=>import("./MonsterCollection.tsx-CRjjwp5k.js"),__vite__mapDeps([8,1,2,3,4,5,6,7])).then(e=>({default:e.MonsterCollection}))),me=W.lazy(()=>q(()=>import("./SettingsScreen.tsx-BbnZeBNr.js"),__vite__mapDeps([9,1,2,3,4,5,6])).then(e=>({default:e.SettingsScreen}))),ue=W.lazy(()=>q(()=>import("./RankingScreen.tsx-DNGv-ouF.js"),__vite__mapDeps([10,1,2,3,4,5,6])).then(e=>({default:e.RankingScreen}))),pe=W.lazy(()=>q(()=>import("./StatsScreen.tsx-BN8lOb-I.js"),__vite__mapDeps([11,1,2,3,4,5,6,12])).then(e=>({default:e.StatsScreen}))),he=W.lazy(()=>q(()=>import("./ExportScreen.tsx-CbNOFR4v.js"),__vite__mapDeps([13,1,2,3,4,5,6])).then(e=>({default:e.ExportScreen}))),ge=()=>H.jsxs("div",{className:"flex items-center justify-center py-12",children:[H.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),H.jsx("p",{className:"ml-4 text-gray-600",children:"読み込み中..."})]}),je=Object.freeze(Object.defineProperty({__proto__:null,MainContent:()=>{const[t,s]=W.useState("quiz"),{isLoading:a,error:l,clearError:i,newAchievements:n,clearAchievement:r,levelUpResult:c,clearNotifications:o,rankingNotifications:d,clearRankingNotification:x}=e();return a?H.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:[H.jsx(G.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"text-6xl",children:"📚"}),H.jsx("p",{className:"ml-4 text-xl text-gray-600",children:"読み込み中..."})]}):H.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[H.jsx(Q,{currentPage:t,onNavigate:s}),H.jsx(re,{achievements:n,onClear:r}),H.jsx(ce,{levelUpResult:c,onClose:()=>o()}),H.jsx(oe,{notification:d[0]||null,onClose:x}),H.jsx("main",{id:"main-content",className:"flex-1 container mx-auto px-4 py-6 pb-20 md:pb-8",tabIndex:-1,children:H.jsxs(B,{mode:"wait",children:[l&&H.jsx(G.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"max-w-4xl mx-auto mb-4",children:H.jsx(le,{type:"network"===l.type?"network":"storage"===l.type||"storage_quota"===l.type?"storage":"validation"===l.type?"validation":"data_load"===l.type?"data":"general",message:l.message,onRetry:()=>{i(),window.location.reload()}})}),H.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"max-w-4xl mx-auto",children:(()=>{const e=(()=>{switch(t){case"quiz":default:return H.jsx(de,{});case"collection":return H.jsx(xe,{});case"ranking":return H.jsx(ue,{});case"stats":return H.jsx(pe,{});case"settings":return H.jsx(me,{onNavigate:s});case"export":return H.jsx(he,{})}})();return H.jsx(W.Suspense,{fallback:H.jsx(ge,{}),children:e})})()},t)]})}),H.jsx(se,{currentPage:t,onNavigate:s})]})}},Symbol.toStringTag,{value:"Module"}));export{X as K,je as M,J as a};
